; THIS EXA FINDS POTENTI
; VALID CC NUMBERS

; GO TO TRASH
LINK 800
LINK 802
LINK 799
GRAB 199

; FIGURE OUT POS DAT LEN
MARK FINDLEN
TEST F < 0 ; = -9999
TJMP BADLEN
ADDI X 1 X
TEST X = 16
TJMP BEGVERIFY
JUMP FINDLEN


MARK BADLEN
COPY 0 X
JUMP FINDLEN


MARK BEGVERIFY
SEEK -16
COPY 1 X

MARK SENVERIFY
COPY F M
MODI X 2 M
ADDI X 1 X
TEST X > 16 ; X = 17
FJMP SENVERIFY
COPY M T; IS VALID?
FJMP VALIDNUMBER ; YES
COPY 0 X ; NO = RESTART
SEEK -15
JUMP FINDLEN ; RESTART


MARK VALIDNUMBER ; END
SEEK -16
COPY 0 X
MARK CPVALNUM
COPY F M
ADDI X 1 X
TEST X = 16
FJMP CPVALNUM